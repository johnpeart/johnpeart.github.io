p > img,
figure,
.composite-image {
    position: relative;
    box-sizing: border-box;
    max-width: 100%;
    padding: 0;
}

p > img,
figure {
    margin: calc(var(--pad) * 2) 0;    
}

@media (min-width: 700px) {
    figure.slide,
    p:has(.slide) {
        height: 100%;
    }
    p > img.slide {
        position: sticky;
        top: 115px;
    }
}

figure.slide,
p > img.slide {
    margin: 0;
    > figcaption { 
        margin: 0 0 clamp(22px, 3vw, 32px);
    }
}

img.hero {
    border: none;
    border-radius: unset;
}

p > img,
figure img,
figure picture {
    z-index: 100;
    border: 3px solid var(--color);
    border-radius: calc(var(--border-radius) * 2);
    padding: 0;
    overflow: hidden;
    
    &.no-styles {
        background: none;
        border: none;
    }
    
    &.fit-to-container {
        width: 100%;
        margin: 0;
    }
}

picture img {
    border: none;
}

figure:has(figcaption) {
    img:first-child,
    picture:first-child {
        border-bottom-left-radius: 0px;
        border-bottom-right-radius: 0px;
    }
    img:nth-child(n+2),
    picture:nth-child(n+2) {
        border-radius: 0;
        border-top: 0;
    }
    img,
    picture {
        border-bottom: 0;
    }
}

p + figure {
    margin-top: var(--pad);
}

figure img {
    display: block;
    position: relative;
    box-sizing: border-box;
    width: 100%;
    height: auto;
    padding: 0;
}

figcaption {
    display: block;
    position: relative;
    
    width: 100%;
    z-index: 999;
    padding: var(--pad);
    margin: 0 0 var(--pad) 0;
    line-height: 1.25;
    text-align: left;
    font-size: clamp(18px, 3vw, 24px);
    background: var(--secondary-background);
    color: var(--color);
    
    border: 3px solid var(--color);
    border-bottom-left-radius: calc(var(--border-radius) * 2);
    border-bottom-right-radius: calc(var(--border-radius) * 2);
    
    p {
        padding: 0 0 var(--pad) 0;
        line-height: 1.25;
        text-align: left;
        font-size: clamp(18px, 3vw, 24px);
        
        &::last-child {
            padding-bottom: 0;
        }
    }
}

picture .background {
    z-index: 1;
    aspect-ratio: 2/1;
    object-fit: cover;
}

.composite-image {
    grid-column: popout;
    
    margin: 0 0 calc(var(--pad) * 4) 0;  
    
    border: var(--border-width) solid var(--color);
    border-radius: calc(var(--border-radius) * 2);
    box-shadow: var(--shadow-deep);
    overflow: hidden;
    
    & img {
        display: grid;
        position: relative;
        box-sizing: border-box;
        width: 100%;
        height: auto;
        padding: 0;
    }
}

div.overlay {
    display: grid;
    position: absolute;
    justify-items: center;
    align-items: center;
    z-index: 100;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: none;
}

@each $value in 5, 10, 20, 50 {
    .overlay-#{$value} {
        -webkit-backdrop-filter: blur(#{$value}px);
        backdrop-filter: blur(#{$value}px);
    }
}

img.overlay {
    all: unset;
    position: relative;
    display: block;
    width: clamp(200px, 60%, 600px);
}

img.app-icon {
    grid-area: icon;
    margin: 0;
    max-height: 57px;
    max-width: 57px;
    
    border-radius: var(--border-radius);
    border: 3px solid var(--color);
    
    &.large {
        @media (min-width: 700px) {
            max-height: 104px;
            max-width: 104px;
        }
    }
}

img.image--16-9 {
    aspect-ratio: 16/9;
    object-fit: cover;
}
